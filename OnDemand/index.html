<!DOCTYPE html>
<html lang="en">
<head>
<link rel="icon" href="Website/Icon.png" type="image/png">
  <meta charset="UTF-8" />
  <title>GAME NIGHT</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
 <style>
    @import url('https://fonts.googleapis.com/css2?family=Orbitron:wght@700&display=swap');

    body {
      font-family: 'Segoe UI', sans-serif;
      background-color: #0a1e3f;
      padding: 2rem;
      color: #e0e7ff;
    }

    h1 {
      text-align: center;
      margin-bottom: 2rem;
      color: #f3ec40;
      text-transform: uppercase;
      font-size: 4rem;
      font-family: 'Orbitron', sans-serif;
    }

    .controls {
      display: flex;
      justify-content: center;
      align-items: center;
      flex-wrap: wrap;
      gap: 1rem;
      margin-bottom: 2rem;
    }

    select, label.checkbox {
      padding: 0.5rem 1rem;
      font-size: 1rem;
      border-radius: 6px;
      border: none;
      background-color: #1e3a8a;
      color: #e0e7ff;
      cursor: pointer;
    }

    label.checkbox {
      display: flex;
      align-items: center;
      gap: 0.5rem;
      background-color: #1e3a8a;
      border-radius: 6px;
      padding: 0.4rem 0.8rem;
    }

    input[type="checkbox"] {
      accent-color: #f3ec40;
      transform: scale(1.2);
    }

    .grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
      gap: 2rem;
      max-width: 3840px;
      margin: 0 auto;
    }

    .card {
      background: #152a5a;
      border-radius: 12px;
      box-shadow: 0 4px 10px rgba(0, 0, 0, 0.5);
      overflow: hidden;
      padding: 1rem;
      text-align: center;
      color: #d1d9ff;
    }
    
    .card:hover {
      box-shadow: 0 8px 20px rgba(243, 236, 64, 0.8);
      transform: translateY(-4px);
    }

    .card iframe {
      width: 100%;
      height: 275px;
      border-radius: 8px;
      border: none;
      background: #000;
    }

    .meta {
      margin-top: 1rem;
    }

    .meta h2 {
    max-height: 6.5em;
    overflow-y: auto;
      margin: 0.5rem 0 0.2rem;
      color: #f3ec40;
      margin-bottom: 0.5rem;
      margin-top: 0.5rem;
      font-size: 1.5rem;
    }

    .meta p {
      margin: 0.2rem;
      color: #a8b2d1;
      font-size: 1.1rem;
      font-style: italic;
     max-height: 8em;
    overflow-y: auto;
      
    }
    
    .meta ep {
      margin: 0.2rem;
      color: #a8b2d1;
      font-size: 1.5rem;
    }

    .hidden {
      display: none !important;
    }
    
    #clearFiltersBtn {
  background-color: firebrick;
  color: #fff;
  border: none;
  padding: 0.5rem 1.2rem;
  border-radius: 6px;
  cursor: pointer;
  font-size: 1rem;
  transition: background-color 0.3s ease;
}
#clearFiltersBtn:hover {
  background-color: #b22222;
}
.thumb-wrapper {
  position: relative;
  display: block;
  border-radius: 1rem;
  overflow: hidden;
}

.thumbnail-img {
  width: 100%;
  display: block;
  border-radius: 1rem;
  transition: transform 0.2s ease;
}

.thumb-wrapper:hover .thumbnail-img {
  transform: scale(1.02);
}

.play-button {
  position: absolute;
  top: 50%;
  left: 50%;
  transform: translate(-55%, -45%);
  pointer-events: none;
  opacity: 0.9;
  filter: drop-shadow(0 0 6px black);
}

#loadingScreen {
  position: fixed;
  top: 0; left: 0;
  width: 100%; height: 100%;
  background: #0a1e3f;
  color: #f3ec40;
  display: flex;
  justify-content: center;
  align-items: center;
  font-size: 4rem;
  z-index: 1000;
}

@media (max-width: 500px) {
  h1 {
    font-size: 2.5rem;
    line-height: 1.2;
    padding: 0 1rem;
  }
  
  .grid {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(75px, 1fr));
  gap: 1rem;
}

@media (min-width: 400px) {
  .grid {
    grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
  }
}

@media (min-width: 700px) {
  .grid {
    grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
  }
}
  .card {
      background: #152a5a;
      border-radius: 12px;
      box-shadow: 0 4px 10px rgba(0, 0, 0, 0.5);
      overflow: hidden;
      padding: 1rem;
      text-align: center;
      color: #d1d9ff;
      width: 80%;
    }

  .thumbnail-img {
    border-radius: 0.75rem;
  }

  .meta h2 {
     max-height: 8em;
    overflow-y: auto;
      margin: 0.5rem 0 0.2rem;
      color: #f3ec40;
      margin-bottom: 0.5rem;
      margin-top: 0.5rem;
      font-size: 0.75rem;
  }

  .meta p, .meta ep {
    font-size: 0.7rem;    
     max-height: 8em;
    overflow-y: auto;
  }
}

@media (max-width: 600px) {
    #loadingScreen {
      font-size: 2rem;
      padding: 0rem;
      text-align: center;
    }
  }
  
  </style>
</head>
<body>
<div id="loadingScreen" style="
  position: fixed;
  top: 0; left: 0;
  width: 100%; height: 100%;
  background: #0a1e3f;
  color: #f3ec40;
  display: flex;
  justify-content: center;
  align-items: center;
  font-size: 3rem;
  z-index: 1000;
"><strong>
  LOADING EPISODES...</strong>
</div>
  <h1 id="mainHeader">GAME NIGHT: ALL SEASONS</h1>
  <div class="controls">
    <select id="seasonSelect"></select>
    <select id="formatFilter">
      <option value="All">All Formats</option>
    </select>
    <label class="checkbox">
      <input type="checkbox" id="hasGuests">Guest Appearance
    </label>
    <label class="checkbox">
      <input type="checkbox" id="hasFeatures"> Feature Episode
    </label>
    <button id="clearFiltersBtn">Clear Filters</button>
  </div>

  <div class="grid" id="episodeGrid"></div>
  
  <p id="noResultsMessage" class="hidden" style="text-align:center; color: firebrick; font-size: 2.5rem; margin-top: 2rem;">
  <strong>NO EPISODES FOUND</strong>
</p>


  <script src="https://cdn.jsdelivr.net/npm/papaparse@5.4.1/papaparse.min.js"></script>
  <script>

  const seasonSources = {
  "Season 1": "https://docs.google.com/spreadsheets/d/e/2PACX-1vSj7yentjlJS9OgA-nYRn8tRm7CTUaSUSaUGWIoUB--XInwzGXD5HsNuDjwfclPOyCkw8rW4MuuN5fM/pub?gid=757152741&single=true&output=csv",
  "Season 2": "https://docs.google.com/spreadsheets/d/e/2PACX-1vSj7yentjlJS9OgA-nYRn8tRm7CTUaSUSaUGWIoUB--XInwzGXD5HsNuDjwfclPOyCkw8rW4MuuN5fM/pub?gid=2023760030&single=true&output=csv",
  "Season 3": "https://docs.google.com/spreadsheets/d/e/2PACX-1vSj7yentjlJS9OgA-nYRn8tRm7CTUaSUSaUGWIoUB--XInwzGXD5HsNuDjwfclPOyCkw8rW4MuuN5fM/pub?gid=301515880&single=true&output=csv",
  "Season 4": "https://docs.google.com/spreadsheets/d/e/2PACX-1vSj7yentjlJS9OgA-nYRn8tRm7CTUaSUSaUGWIoUB--XInwzGXD5HsNuDjwfclPOyCkw8rW4MuuN5fM/pub?gid=1288561065&single=true&output=csv",
  "Season 5": "https://docs.google.com/spreadsheets/d/e/2PACX-1vSj7yentjlJS9OgA-nYRn8tRm7CTUaSUSaUGWIoUB--XInwzGXD5HsNuDjwfclPOyCkw8rW4MuuN5fM/pub?gid=1845908747&single=true&output=csv",
  "Season 6": "https://docs.google.com/spreadsheets/d/e/2PACX-1vSj7yentjlJS9OgA-nYRn8tRm7CTUaSUSaUGWIoUB--XInwzGXD5HsNuDjwfclPOyCkw8rW4MuuN5fM/pub?gid=449618691&single=true&output=csv",
  "Season 7": "https://docs.google.com/spreadsheets/d/e/2PACX-1vSj7yentjlJS9OgA-nYRn8tRm7CTUaSUSaUGWIoUB--XInwzGXD5HsNuDjwfclPOyCkw8rW4MuuN5fM/pub?gid=662667958&single=true&output=csv",
  "Season 8": "https://docs.google.com/spreadsheets/d/e/2PACX-1vSj7yentjlJS9OgA-nYRn8tRm7CTUaSUSaUGWIoUB--XInwzGXD5HsNuDjwfclPOyCkw8rW4MuuN5fM/pub?gid=378990445&single=true&output=csv",
  "Season 9": "https://docs.google.com/spreadsheets/d/e/2PACX-1vSj7yentjlJS9OgA-nYRn8tRm7CTUaSUSaUGWIoUB--XInwzGXD5HsNuDjwfclPOyCkw8rW4MuuN5fM/pub?gid=1144281968&single=true&output=csv",
  "Season 10": "https://docs.google.com/spreadsheets/d/e/2PACX-1vSj7yentjlJS9OgA-nYRn8tRm7CTUaSUSaUGWIoUB--XInwzGXD5HsNuDjwfclPOyCkw8rW4MuuN5fM/pub?gid=859905086&single=true&output=csv",
  "Season 11": "https://docs.google.com/spreadsheets/d/e/2PACX-1vSj7yentjlJS9OgA-nYRn8tRm7CTUaSUSaUGWIoUB--XInwzGXD5HsNuDjwfclPOyCkw8rW4MuuN5fM/pub?gid=1617015858&single=true&output=csv",
  "Season 12": "https://docs.google.com/spreadsheets/d/e/2PACX-1vSj7yentjlJS9OgA-nYRn8tRm7CTUaSUSaUGWIoUB--XInwzGXD5HsNuDjwfclPOyCkw8rW4MuuN5fM/pub?gid=552496685&single=true&output=csv",
  "Season 13": "https://docs.google.com/spreadsheets/d/e/2PACX-1vSj7yentjlJS9OgA-nYRn8tRm7CTUaSUSaUGWIoUB--XInwzGXD5HsNuDjwfclPOyCkw8rW4MuuN5fM/pub?gid=2132100717&single=true&output=csv",
  "Season 14": "https://docs.google.com/spreadsheets/d/e/2PACX-1vSj7yentjlJS9OgA-nYRn8tRm7CTUaSUSaUGWIoUB--XInwzGXD5HsNuDjwfclPOyCkw8rW4MuuN5fM/pub?gid=1201410527&single=true&output=csv",
  "Season 15": "https://docs.google.com/spreadsheets/d/e/2PACX-1vSj7yentjlJS9OgA-nYRn8tRm7CTUaSUSaUGWIoUB--XInwzGXD5HsNuDjwfclPOyCkw8rW4MuuN5fM/pub?gid=1389368663&single=true&output=csv",
  "Season 16": "https://docs.google.com/spreadsheets/d/e/2PACX-1vSj7yentjlJS9OgA-nYRn8tRm7CTUaSUSaUGWIoUB--XInwzGXD5HsNuDjwfclPOyCkw8rW4MuuN5fM/pub?gid=1645022033&single=true&output=csv",
  "Season 17": "https://docs.google.com/spreadsheets/d/e/2PACX-1vSj7yentjlJS9OgA-nYRn8tRm7CTUaSUSaUGWIoUB--XInwzGXD5HsNuDjwfclPOyCkw8rW4MuuN5fM/pub?gid=1776757633&single=true&output=csv",
  "Season 18": "https://docs.google.com/spreadsheets/d/e/2PACX-1vSj7yentjlJS9OgA-nYRn8tRm7CTUaSUSaUGWIoUB--XInwzGXD5HsNuDjwfclPOyCkw8rW4MuuN5fM/pub?gid=160676996&single=true&output=csv",
  "Season 19": "https://docs.google.com/spreadsheets/d/e/2PACX-1vSj7yentjlJS9OgA-nYRn8tRm7CTUaSUSaUGWIoUB--XInwzGXD5HsNuDjwfclPOyCkw8rW4MuuN5fM/pub?gid=1913635729&single=true&output=csv",
  "Season 20": "https://docs.google.com/spreadsheets/d/e/2PACX-1vSj7yentjlJS9OgA-nYRn8tRm7CTUaSUSaUGWIoUB--XInwzGXD5HsNuDjwfclPOyCkw8rW4MuuN5fM/pub?gid=233501622&single=true&output=csv"
};

  const seasonData = {};
  const formatSet = new Set();
  let cards = [];

  const getYouTubeID = (url) => {
    const match = url.match(/(?:youtube\.com.*[?&]v=|youtu\.be\/)([a-zA-Z0-9_-]+)/);
    return match ? match[1] : null;
  };

  async function loadSeasonOptions() {
    const seasonSelect = document.getElementById("seasonSelect");
    seasonSelect.innerHTML = '';
    const allOption = document.createElement("option");
    allOption.value = "All Seasons";
    allOption.textContent = "All Seasons";
    seasonSelect.appendChild(allOption);

    for (const [name, url] of Object.entries(seasonSources)) {
      seasonData[name] = url;
      const opt = document.createElement("option");
      opt.value = name;
      opt.textContent = name;
      seasonSelect.appendChild(opt);
    }

    seasonSelect.addEventListener("change", () => {
      document.getElementById("mainHeader").textContent = `Game Night: ${seasonSelect.value}`;
      renderSeason(seasonSelect.value);
    });

    const latestSeason = Object.keys(seasonSources).slice(-1)[0];
    renderSeason(latestSeason);
    document.getElementById("seasonSelect").value = latestSeason;
    document.getElementById("mainHeader").textContent = `Game Night: ${latestSeason}`;
  }

  function parseCSV(csv) {
    return new Promise((resolve) => {
      Papa.parse(csv, {
        header: true,
        skipEmptyLines: true,
        complete: (results) => resolve(results.data)
      });
    });
  }

  async function renderSeason(seasonName) {
  document.getElementById("loadingScreen").style.display = "flex";

  formatSet.clear();
  cards = [];
  document.getElementById("episodeGrid").innerHTML = "";

  if (seasonName === "All Seasons") {
    const csvPromises = Object.values(seasonSources).map(url => fetch(url).then(res => res.text()));
    const csvContents = await Promise.all(csvPromises);
    const allRowsPromises = csvContents.map(parseCSV);
    const allRows = (await Promise.all(allRowsPromises)).flat();
    displayCards(allRows);
  } else {
    const response = await fetch(seasonSources[seasonName]);
    const csvText = await response.text();
    const rows = await parseCSV(csvText);
    displayCards(rows);
  }

  document.getElementById("loadingScreen").style.display = "none";
}

  function displayCards(rows) {
    const container = document.getElementById("episodeGrid");
    const formatDropdown = document.getElementById("formatFilter");
    formatDropdown.innerHTML = '<option value="All">All Formats</option>';

    rows.forEach((row) => {
      const videoId = getYouTubeID(row['YouTube Link']);
      if (!videoId) return;

      const formatList = (row.Formats || '').split(/[,;&]+/).map(f => f.trim()).filter(f => f);
      formatList.forEach(f => formatSet.add(f));

      const card = document.createElement('div');
      card.className = 'card';
      card.setAttribute('data-formats', formatList.join('|'));
      card.setAttribute('data-guests', row.Guests ? '1' : '0');
      card.setAttribute('data-features', row.Features ? '1' : '0');

      card.innerHTML = `
      
  <a href="https://www.youtube.com/watch?v=${videoId}" target="_blank" rel="noopener" class="thumb-wrapper">
    <img src="https://img.youtube.com/vi/${videoId}/hqdefault.jpg" alt="YouTube Thumbnail" class="thumbnail-img" />
    <div class="play-button">
      <svg viewBox="0 0 100 100" width="128" height="128" fill="white">
        <polygon points="40,30 70,50 40,70" />
      </svg>
    </div>
  </a>
  <div class="meta">
    <ep><strong>${row.Episode || 'Untitled'} ${row.Ordinal || 'Untitled'}</strong></ep>
    <p><strong>${row.Date || ''}</strong></p>
    <h2>${formatMultiline(row.Formats || 'N/A')}</h2>
    ${row.Guests ? `<p><i>Guests:</i> ${row.Guests}</p>` : ''}
    ${row.Features ? `<p><i>Feature:</i> ${row.Features}</p>` : ''}
  </div>
`;
      cards.push(card);
      container.appendChild(card);
    });

    Array.from(formatSet).sort((a, b) => a.localeCompare(b, undefined, { sensitivity: 'base' }))
      .forEach(format => {
        const opt = document.createElement('option');
        opt.value = format;
        opt.textContent = format;
        formatDropdown.appendChild(opt);
      });

    applyFilters();
  }
  
  function formatMultiline(formatString) {
  return formatString
    .split(/[,&]+/)                 // Split on commas or ampersands
    .map(s => s.trim())            // Trim whitespace
    .filter(Boolean)               // Remove empty strings
    .join('<br>');                 // Join with line breaks
}

 function applyFilters() {
  const selectedFormat = document.getElementById("formatFilter").value;
  const requireGuests = document.getElementById("hasGuests").checked;
  const requireFeatures = document.getElementById("hasFeatures").checked;

  let visibleCount = 0;
  cards.forEach(card => {
    const formats = card.getAttribute('data-formats').split('|');
    const hasGuest = card.getAttribute('data-guests') === '1';
    const hasFeature = card.getAttribute('data-features') === '1';
    const matchesFormat = selectedFormat === "All" || formats.includes(selectedFormat);
    const matchesGuest = !requireGuests || hasGuest;
    const matchesFeature = !requireFeatures || hasFeature;

    const isVisible = matchesFormat && matchesGuest && matchesFeature;
    card.classList.toggle('hidden', !isVisible);
    if (isVisible) visibleCount++;
  });

  document.getElementById("noResultsMessage").classList.toggle("hidden", visibleCount > 0);
}

  document.getElementById("clearFiltersBtn").addEventListener("click", () => {
  document.getElementById("formatFilter").value = "All";
  document.getElementById("hasGuests").checked = false;
  document.getElementById("hasFeatures").checked = false;
  applyFilters();
});

document.getElementById("formatFilter").addEventListener("change", applyFilters);
document.getElementById("hasGuests").addEventListener("change", applyFilters);
document.getElementById("hasFeatures").addEventListener("change", applyFilters);
  loadSeasonOptions();

  </script>
</body>
</html>
